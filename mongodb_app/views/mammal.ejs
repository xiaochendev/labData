<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= mammal.name %> - Mammal</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <main class="mammal-page">
        <%- include('partials/nav') %>
        <%- include('partials/messages') %>
        <!--  Edit Form -->
        <section class="mammal-form">
            <h2>Edit Mammal</h2>
            <form action="/api/mammals/<%= mammal._id %>?_method=PUT" method="POST">
                <label>Name: <input type="text" name="name" value="<%= mammal.name %>" required /></label>
                <label>Species: <input type="text" name="species" value="<%= mammal.species %>" /></label>
                <label>Age: <input type="number" name="age" value="<%= mammal.age %>" min="0" required /></label><br/>
                <label>Habitat (comma-separated): 
                    <input type="text" name="habitat" 
                        value="<%= mammal.habitat ? mammal.habitat.join(', ') : '' %>" 
                        placeholder="e.g. desert, forest" required />
                </label><br/>
                <label>
                    <input type="checkbox" name="isAdopted" <%= mammal.isAdopted ? "checked" : "" %> />
                    Adopted
                </label>
                <label>Adoption Date:
                    <input type="date" name="adoptionDate" value="<%= mammal.adoptionDate ? mammal.adoptionDate.toISOString().split('T')[0] : '' %>" />
                </label>
                <label>Adopter Name:
                    <input type="text" name="adopterName" value="<%= mammal.adopterName || '' %>" />
                </label><br/>
                <label>Adopter Contact:
                    <input type="text" name="adopterContact" value="<%= mammal.adopterContact || '' %>" />
                </label>
                <label>Arrival Date:
                    <input type="date" name="arrivalDate" value="<%= mammal.arrivalDate ? mammal.arrivalDate.toISOString().split('T')[0] : '' %>" required />
                </label>
                <label>Health Status:
                    <input type="text" name="healthStatus" value="<%= mammal.healthStatus || '' %>" />
                </label>
                <label>
                    <input type="checkbox" name="vaccinated" <%= mammal.vaccinated ? "checked" : "" %> />
                    Vaccinated
                </label>
                <label>Microchip ID:
                    <input type="text" name="microchipId" value="<%= mammal.microchipId || '' %>" />
                </label>
                <button type="submit">Update Mammal</button>
            </form>

            <form action="/api/mammals/<%= mammal._id %>?_method=DELETE" method="POST" onsubmit="return confirm('Are you sure?')">
                <button type="submit">Delete Mammal</button>
            </form>
        </section>

        <!--  Mammal Detail -->
        <section class="mammal-detail">
            <h1><%= mammal.name %></h1>
            <dl>
              <dt>Species:</dt>
              <dd><%= mammal.species %></dd>
            
              <dt>Age:</dt>
              <dd><%= mammal.age %> years 
                <% if (mammal.old) { %>
                    <em>(Senior)</em>
                <% } %>
              </dd>
            
              <dt>Habitat(s):</dt>
              <dd>
                <% if (mammal.habitat && mammal.habitat.length > 0) { %>
                  <%= mammal.habitat.join(', ') %>
                <% } else { %>
                  Not specified
                <% } %>
              </dd>
          
              <dt>Arrival Date:</dt>
              <dd>
                <%= mammal.arrivalDate ? new Date(mammal.arrivalDate).toLocaleDateString() : 'Unknown' %>
              </dd>
          
              <dt>Health Status:</dt>
              <dd><%= mammal.healthStatus || 'Unknown' %></dd>
          
              <dt>Vaccinated:</dt>
              <dd><%= mammal.vaccinated ? 'Yes' : 'No' %></dd>
          
              <dt>Microchip ID:</dt>
              <dd><%= mammal.microchipId || 'Not available' %></dd>
          
              <dt>Adoption Status:</dt>
              <dd>
                <% if (mammal.isAdopted) { %>
                  ‚úÖ Adopted
                  <% if (mammal.adoptionDate) { %> on <%= new Date(mammal.adoptionDate).toLocaleDateString() %><% } %>
                  <br>
                  <strong>Adopter:</strong> <%= mammal.adopterName || 'Unknown' %> (<%= mammal.adopterContact || 'No contact info' %>)
                <% } else { %>
                  üêæ Available for adoption
                <% } %>
              </dd>
            </dl>
        </section>
    </main>
</body>
</html>
